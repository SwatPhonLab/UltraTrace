#!/bin/bash
#
# Executable wrapper around the ultratrace module so
# that it can be executed from anywhere on the system.
# This _should_ support both MacOS and Linux, but not
# Windows.

# Exit early if any of our commands fail.
set -euo pipefail

__realpath() {
    # It looks like getting readlink(1) and/or realpath(1) to work in
    # a reliable cross-platform way is probably difficult ... so let's
    # just let Python do it for us :^)
    python3 -c "import os; print(os.path.realpath('$1'))"
}

# `cd` to the repository root.
cd "$(basename "$(__realpath "$0")")/.."

# Pass all arguments through to `ultratrace`.  We should be letting the
# argparse section of `__main__.py` be handling errors and generating nice
# user-facing text.
python3 -m ultratrace "$@"
