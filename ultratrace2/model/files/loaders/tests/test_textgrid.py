from typing import Sequence, Tuple

import pytest

from ..base import FileLoadError
from ..textgrid import TextGridLoader


@pytest.mark.parametrize(
    "path", ["", "/path/to/nowhere", "/dev/null", "/etc/sudoers"],
)
def test_loading_from_invalid_file(path) -> None:
    with pytest.raises(FileLoadError):
        TextGridLoader.from_file(path)


@pytest.mark.parametrize(
    "path,tier_names,intervals,start_time,end_time",
    [
        # FIXME: The textgrid library is unable to parse `manual-00-short` and `manual-00-mixed`
        #        even though those are taken directly from the Praat TextGrid file formats page.
        #        We should probably (eventually) commit upstream to the textgrid lib directly
        #        and then add those tests here.
        (
            "./test-data/example-textgrid/manual-00-pretty.TextGrid",
            ["Mary", "John", "bell"],
            [("Mary", []), ("John", [])],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-01-ascii.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, 'kej "ahoj" dvakrt')]),
                (
                    "phonemes",
                    [(0.0, 0.7, "rikj"), (0.7, 1.6, "aj"), (1.6, 2.3, "dakrat")],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-01-latin1.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, 'нkej "ahoj" dvakrбt')]),
                (
                    "phonemes",
                    [(0.0, 0.7, "rikj"), (0.7, 1.6, "aj"), (1.6, 2.3, "dakrat")],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-01-macroman.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, '’kej "ahoj" dvakr‡t')]),
                (
                    "phonemes",
                    [(0.0, 0.7, "rikj"), (0.7, 1.6, "aj"), (1.6, 2.3, "dakrat")],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-01-utf16.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, 'říkej "ahoj" dvakrát')]),
                (
                    "phonemes",
                    [
                        (0.0, 0.7, "r̝iːkɛj"),
                        (0.7, 1.6, "ʔaɦɔj"),
                        (1.6, 2.3, "dʋakraːt"),
                    ],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-01-utf8.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, 'říkej "ahoj" dvakrát')]),
                (
                    "phonemes",
                    [
                        (0.0, 0.7, "r̝iːkɛj"),
                        (0.7, 1.6, "ʔaɦɔj"),
                        (1.6, 2.3, "dʋakraːt"),
                    ],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/example-textgrid/manual-02.TextGrid",
            ["sentence", "phonemes", "bell"],
            [
                ("sentence", [(0.0, 2.3, "\\r<\\i'kej \"ahoj\" dvakr\\a't")]),
                (
                    "phonemes",
                    [
                        (0.0, 0.7, "r\\T^i\\:fk\\efj"),
                        (0.7, 1.6, "\\?ga\\h^\\ctj"),
                        (1.6, 2.3, "d\\vsakra\\:ft"),
                    ],
                ),
            ],
            0.0,
            2.3,
        ),
        (
            "./test-data/ftyers/20150629171639.TextGrid",
            [
                "sentence",
                "word",
                "orthographic vowel",
                "all frames",
                "all frames",
                "all frames.original",
            ],
            [
                (
                    "sentence",
                    [
                        (
                            1.13305,
                            6.30017,
                            "The North Wind and the Sun were disputing which of them was stronger when a traveler came along wrapped in a warm cloak",
                        ),
                        (
                            6.61652,
                            12.3503,
                            "They agreed that the one who first succeeded in making the traveler take his cloak off should be considered the stronger - of the two",
                        ),
                        (
                            12.82174,
                            20.15046,
                            "Then the North Wind blew as hard as he could but the more he blew the more closely did the traveler fold his cloak around him and at last the North Wind gave up the attempt",
                        ),
                        (
                            20.51291,
                            27.9785,
                            "Then the Sun shone out warmly and immediately the traveler took off his cloak and so the North Wind was obliged to confess that the Sun was the stronger of the two",
                        ),
                    ],
                ),
                (
                    "word",
                    [
                        (1.1741, 1.26303, "The"),
                        (1.26303, 1.53488, "North"),
                        (1.53488, 1.72617, "Wind"),
                        (1.72617, 1.85098, "and"),
                        (1.85098, 1.90515, "the"),
                        (1.90515, 2.20277, "Sun"),
                        (2.20277, 2.27132, "were"),
                        (2.27132, 2.83808, "disputing"),
                        (2.83808, 3.04897, "which"),
                        (3.04897, 3.13477, "of"),
                        (3.13477, 3.2975, "them"),
                        (3.2975, 3.4244, "was"),
                        (3.4244, 3.86055, "stronger"),
                        (4.15649, 4.2791, "when"),
                        (4.2791, 4.35674, "a"),
                        (4.35674, 4.71045, "traveler"),
                        (4.71045, 4.94699, "came"),
                        (4.94699, 5.21364, "along"),
                        (5.21364, 5.49714, "wrapped"),
                        (5.49714, 5.566, "in"),
                        (5.566, 5.60618, "a"),
                        (5.60618, 5.89004, "warm"),
                        (5.89004, 6.26946, "cloak"),
                        (6.63021, 6.75009, "They"),
                        (6.75009, 7.04638, "agreed"),
                        (7.04638, 7.18678, "that"),
                        (7.18678, 7.25354, "the"),
                        (7.25354, 7.48102, "one"),
                        (7.48102, 7.59326, "who"),
                        (7.59326, 7.88381, "first"),
                        (7.88381, 8.37525, "succeeded"),
                        (8.37525, 8.47671, "in"),
                        (8.47671, 8.79612, "making"),
                        (8.79612, 8.84137, "the"),
                        (8.84137, 9.21158, "traveler"),
                        (9.21158, 9.46704, "take"),
                        (9.46704, 9.59498, "his"),
                        (9.59498, 9.92845, "cloak"),
                        (9.92845, 10.11975, "off"),
                        (10.14108, 10.34043, "should"),
                        (10.34043, 10.45967, "be"),
                        (10.45967, 10.91663, "considered"),
                        (10.91663, 11.02239, "the"),
                        (11.02239, 11.39659, "stronger"),
                        (11.39659, 11.43174, "of"),
                        (11.43174, 11.61046, "the"),
                        (11.77425, 11.8946, "of"),
                        (11.8946, 12.02365, "the"),
                        (12.02365, 12.28886, "two"),
                        (12.88976, 13.04955, "Then"),
                        (13.04955, 13.10145, "the"),
                        (13.10145, 13.3804, "North"),
                        (13.3804, 13.60097, "Wind"),
                        (13.60097, 13.7353, "blew"),
                        (13.7353, 13.90427, "as"),
                        (13.90427, 14.1768, "hard as"),
                        (14.1768, 14.26991, "he"),
                        (14.26991, 14.52342, "could"),
                        (14.77763, 14.84847, "but"),
                        (14.84847, 14.91004, "the"),
                        (14.91004, 15.1006, "more"),
                        (15.1006, 15.24618, "he"),
                        (15.24618, 15.50006, "blew"),
                        (15.50006, 15.55004, "the"),
                        (15.55004, 15.73678, "more"),
                        (15.73678, 16.14386, "closely"),
                        (16.14386, 16.27216, "did"),
                        (16.27216, 16.35921, "the"),
                        (16.35921, 16.6905, "traveler"),
                        (16.6905, 16.94599, "fold"),
                        (16.94599, 17.08592, "his"),
                        (17.08592, 17.3618, "cloak"),
                        (17.3618, 17.65188, "around"),
                        (17.65188, 17.87502, "him"),
                        (18.1661, 18.23755, "and"),
                        (18.23755, 18.3371, "at"),
                        (18.3371, 18.61213, "last"),
                        (18.61213, 18.67544, "the"),
                        (18.67544, 18.97427, "North"),
                        (18.97427, 19.21412, "Wind"),
                        (19.21412, 19.41082, "gave"),
                        (19.41082, 19.5304, "up"),
                        (19.5304, 19.63142, "the "),
                        (19.63142, 20.1171, "attempt"),
                        (20.52291, 20.73339, "Then"),
                        (20.73339, 20.79474, "the"),
                        (20.79474, 21.06328, "sun"),
                        (21.06328, 21.27853, "shone"),
                        (21.27853, 21.45237, "out"),
                        (21.45237, 21.88008, "warmly"),
                        (22.26467, 22.38812, "and"),
                        (22.38812, 22.89013, "immediately"),
                        (22.89013, 22.98207, "the"),
                        (22.98207, 23.34444, "traveler"),
                        (23.34444, 23.54744, "took"),
                        (23.54744, 23.69483, "off"),
                        (23.69483, 23.82288, "his"),
                        (23.82288, 24.17364, "cloak"),
                        (24.43011, 24.51298, "and"),
                        (24.51298, 24.68153, "so"),
                        (24.68153, 24.76507, "the"),
                        (24.76507, 25.0629, "North"),
                        (25.0629, 25.28546, "Wind"),
                        (25.28546, 25.43242, "was"),
                        (25.43242, 25.81091, "obliged"),
                        (25.81091, 25.8854, "to"),
                        (25.8854, 26.34972, "confess"),
                        (26.34972, 26.50665, "that"),
                        (26.50665, 26.57972, "the"),
                        (26.57972, 26.81976, "sun"),
                        (26.81976, 27.03761, "was"),
                        (27.03761, 27.08438, "the"),
                        (27.08438, 27.50286, "stronger"),
                        (27.50286, 27.5566, "of"),
                        (27.5566, 27.68696, "the"),
                        (27.68696, 27.96531, "two"),
                    ],
                ),
                (
                    "orthographic vowel",
                    [
                        (1.21054, 1.25753, "e"),
                        (1.30925, 1.44417, "o"),
                        (1.59274, 1.62757, "i"),
                        (1.72674, 1.78484, "a"),
                        (1.85778, 1.9017, "e"),
                        (2.01965, 2.10287, "u"),
                        (2.2301, 2.26511, "e"),
                        (2.32825, 2.34117, "i"),
                        (2.51195, 2.58627, "u"),
                        (2.70273, 2.74322, "i"),
                        (2.89803, 2.93894, "i"),
                        (3.05032, 3.10246, "o"),
                        (3.15315, 3.21387, "e"),
                        (3.31534, 3.34849, "a"),
                        (3.55822, 3.60366, "o"),
                        (3.70936, 3.81198, "e"),
                        (4.22392, 4.2472, "e"),
                        (4.28098, 4.33702, "a"),
                        (4.46113, 4.5316, "a"),
                        (4.56105, 4.5983, "e"),
                        (4.63398, 4.6752, "e"),
                        (4.78859, 4.87856, "a"),
                        (4.94777, 4.99212, "a"),
                        (5.03839, 5.11906, "o"),
                        (5.29286, 5.35461, "a"),
                        (5.50137, 5.52856, "i"),
                        (5.56653, 5.60475, "a"),
                        (5.7216, 5.79217, "a"),
                        (6.00126, 6.10843, "o"),
                        (6.67259, 6.74766, "e"),
                        (6.75249, 6.77923, "a"),
                        (6.93534, 7.00285, "e"),
                        (7.08278, 7.14906, "a"),
                        (7.22381, 7.2493, "e"),
                        (7.36447, 7.41169, "o"),
                        (7.52924, 7.59317, "o"),
                        (7.73381, 7.82358, "i"),
                        (7.95135, 7.98338, "u"),
                        (8.13638, 8.22631, "e"),
                        (8.2618, 8.33114, "e"),
                        (8.3779, 8.41589, "i"),
                        (8.51753, 8.60435, "a"),
                        (8.79711, 8.84106, "e"),
                        (8.96588, 9.03969, "a"),
                        (9.08128, 9.10996, "e"),
                        (9.13811, 9.18936, "e"),
                        (9.29406, 9.38309, "a"),
                        (9.48481, 9.512, "i"),
                        (9.72107, 9.81258, "o"),
                        (9.93806, 10.02836, "o"),
                        (10.25625, 10.28977, "o"),
                        (10.37135, 10.42742, "e"),
                        (10.69188, 10.74955, "i"),
                        (10.79516, 10.86778, "e"),
                        (10.97614, 11.01711, "e"),
                        (11.19716, 11.23255, "o"),
                        (11.40279, 11.42924, "o"),
                        (11.48295, 11.59318, "e"),
                        (11.79265, 11.83251, "o"),
                        (11.95444, 11.99504, "e"),
                        (12.11569, 12.23942, "o"),
                        (12.91914, 12.97725, "e"),
                        (13.05551, 13.10018, "e"),
                        (13.16461, 13.28182, "o"),
                        (13.43099, 13.48574, "i"),
                        (13.6752, 13.72511, "e"),
                        (13.75193, 13.81339, "a"),
                        (13.9624, 14.05128, "a"),
                        (14.05416, 14.08059, "a"),
                        (14.1849, 14.24126, "e"),
                        (14.36409, 14.4412, "o"),
                        (14.79647, 14.84266, "u"),
                        (14.87761, 14.90833, "e"),
                        (14.98334, 15.09953, "o"),
                        (15.1612, 15.19395, "e"),
                        (15.348, 15.45657, "e"),
                        (15.52658, 15.54893, "e"),
                        (15.62545, 15.70442, "o"),
                        (15.84118, 15.92946, "o"),
                        (16.0479, 16.10377, "y"),
                        (16.17543, 16.21789, "i"),
                        (16.29724, 16.32735, "e"),
                        (16.44795, 16.51754, "a"),
                        (16.57203, 16.6006, "e"),
                        (16.63971, 16.66466, "e"),
                        (16.78637, 16.86468, "o"),
                        (16.95277, 17.01146, "i"),
                        (17.18009, 17.2598, "o"),
                        (17.36391, 17.40483, "a"),
                        (17.47948, 17.58872, "o"),
                        (17.7161, 17.76816, "i"),
                        (18.16614, 18.20563, "a"),
                        (18.2401, 18.31982, "a"),
                        (18.38802, 18.47113, "a"),
                        (18.64363, 18.67524, "e"),
                        (18.73857, 18.84152, "o"),
                        (19.01743, 19.05791, "i"),
                        (19.26459, 19.36106, "a"),
                        (19.41437, 19.48562, "u"),
                        (19.59077, 19.62499, "e"),
                        (19.64392, 19.68985, "a"),
                        (19.80055, 19.87133, "e"),
                        (20.57713, 20.66376, "e"),
                        (20.74309, 20.79301, "e"),
                        (20.90548, 20.9799, "u"),
                        (21.18777, 21.24849, "o"),
                        (21.28076, 21.42402, "o"),
                        (21.53542, 21.62601, "a"),
                        (21.72915, 21.81974, "y"),
                        (22.29646, 22.35145, "a"),
                        (22.389, 22.42886, "i"),
                        (22.4999, 22.6171, "e"),
                        (22.66547, 22.74704, "a"),
                        (22.78985, 22.87798, "y"),
                        (22.91826, 22.95402, "e"),
                        (23.0875, 23.14896, "a"),
                        (23.25815, 23.31052, "e"),
                        (23.40988, 23.45607, "o"),
                        (23.54803, 23.6216, "o"),
                        (23.70222, 23.7499, "i"),
                        (23.92623, 24.04133, "o"),
                        (24.43929, 24.48175, "a"),
                        (24.59156, 24.68058, "o"),
                        (24.71881, 24.76425, "e"),
                        (24.82966, 24.92956, "o"),
                        (25.12872, 25.16773, "i"),
                        (25.33998, 25.38579, "a"),
                        (25.43405, 25.47167, "o"),
                        (25.58946, 25.70857, "i"),
                        (26.13167, 26.22926, "e"),
                        (26.39529, 26.46011, "a"),
                        (26.52107, 26.57903, "e"),
                        (26.69589, 26.76256, "u"),
                        (26.89584, 26.94762, "a"),
                        (27.04356, 27.08416, "e"),
                        (27.23584, 27.28884, "o"),
                        (27.38195, 27.4168, "e"),
                        (27.50524, 27.52014, "o"),
                        (27.615, 27.65206, "e"),
                        (27.76229, 27.86511, "o"),
                    ],
                ),
            ],
            0.0,
            28.2,
        ),
        (
            "./test-data/qumuq/File001.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.93943, 1.99264, "qa")])],
            0.0,
            6.17651,
        ),
        (
            "./test-data/qumuq/File002.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.16248, 2.22355, "qa")])],
            0.0,
            3.65714,
        ),
        (
            "./test-data/qumuq/File003.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.83472, 2.87745, "hu")])],
            0.0,
            4.52789,
        ),
        (
            "./test-data/qumuq/File004.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.63815, 2.72688, "qu")])],
            0.0,
            4.58594,
        ),
        (
            "./test-data/qumuq/File005.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.21314, 2.26784, "qu")])],
            0.0,
            3.52943,
        ),
        (
            "./test-data/qumuq/File006.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.2178, 2.28321, "qo")])],
            0.0,
            3.86612,
        ),
        (
            "./test-data/qumuq/File007.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.34781, 2.38584, "qo")])],
            0.0,
            3.99383,
        ),
        (
            "./test-data/qumuq/File008.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.10069, 2.15859, "qy")])],
            0.0,
            3.87773,
        ),
        (
            "./test-data/qumuq/File009.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.20942, 2.25576, "qy")])],
            0.0,
            3.58748,
        ),
        (
            "./test-data/qumuq/File010.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.58067, 2.62575, "ke")])],
            0.0,
            4.48145,
        ),
        (
            "./test-data/qumuq/File011.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.27343, 2.32168, "ke")])],
            0.0,
            3.87773,
        ),
        (
            "./test-data/qumuq/File012.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.07421, 2.12072, "kyu")])],
            0.0,
            3.78485,
        ),
        (
            "./test-data/qumuq/File013.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.40478, 2.49015, "kyu")])],
            0.0,
            4.16798,
        ),
        (
            "./test-data/qumuq/File014.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.58642, 2.63381, "kyo")])],
            0.0,
            4.00544,
        ),
        (
            "./test-data/qumuq/File015.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.17211, 2.22538, "gyo")])],
            0.0,
            3.91256,
        ),
        (
            "./test-data/qumuq/File016.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.30034, 2.34592, "kyo"), (2.44509, 2.48543, "kyo")])],
            0.0,
            4.28408,
        ),
        (
            "./test-data/qumuq/File017.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.2721, 2.3223, "ki")])],
            0.0,
            4.31891,
        ),
        (
            "./test-data/qumuq/File018.TextGrid",
            ["annotation_0", "annotation_1"],
            [
                ("annotation_0", [(2.22421, 2.2718, "ki")]),
                ("annotation_1", [(2.22388, 2.27278, "ki")]),
            ],
            0.0,
            4.04027,
        ),
        (
            "./test-data/qumuq/File019.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.09779, 2.13957, "gi")])],
            0.0,
            4.06349,
        ),
        (
            "./test-data/qumuq/File020.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.04628, 2.10793, "ge")])],
            0.0,
            4.04027,
        ),
        (
            "./test-data/qumuq/File021.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.07854, 2.13522, "ge")])],
            0.0,
            3.98222,
        ),
        (
            "./test-data/qumuq/File022.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.07058, 2.12062, "gyu")])],
            0.0,
            4.09832,
        ),
        (
            "./test-data/qumuq/File023.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.06821, 2.14229, "gyu")])],
            0.0,
            4.24925,
        ),
        (
            "./test-data/qumuq/File024.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.09652, 2.14453, "gyo")])],
            0.0,
            4.04027,
        ),
        (
            "./test-data/qumuq/File025.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.11358, 2.16484, "gi")])],
            0.0,
            4.05188,
        ),
        (
            "./test-data/qumuq/File026.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.67932, 2.71989, "qa")])],
            0.0,
            4.82975,
        ),
        (
            "./test-data/qumuq/File027.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.46998, 2.56039, "qa")])],
            0.0,
            4.69043,
        ),
        (
            "./test-data/qumuq/File028.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.45969, 2.46637, "qu")])],
            0.0,
            4.51628,
        ),
        (
            "./test-data/qumuq/File029.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.21021, 2.2274, "qo")])],
            0.0,
            4.45823,
        ),
        (
            "./test-data/qumuq/File030.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.18686, 2.25073, "qo")])],
            0.0,
            3.92417,
        ),
        (
            "./test-data/qumuq/File031.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.48159, 1.51862, "qy")])],
            0.0,
            4.17959,
        ),
        (
            "./test-data/qumuq/File032.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.11058, 2.15365, "kyu")])],
            0.0,
            4.52789,
        ),
        (
            "./test-data/qumuq/File033.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.18819, 2.21932, "kyo")])],
            0.0,
            4.15637,
        ),
        (
            "./test-data/qumuq/File034.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(2.13509, 2.17395, "ke")])],
            0.0,
            4.79492,
        ),
        (
            "./test-data/qumuq/File035.TextGrid",
            ["annotation_0", "PointTier_0"],
            [("annotation_0", [(1.59137, 1.66228, "qa")])],
            0.0,
            2.70512,
        ),
        (
            "./test-data/qumuq/File036.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.42596, 1.51891, "qa")])],
            0.0,
            2.73995,
        ),
        (
            "./test-data/qumuq/File037.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.37714, 1.43278, "hu")])],
            0.0,
            3.00698,
        ),
        (
            "./test-data/qumuq/File038.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.31126, 1.39279, "qu")])],
            0.0,
            2.93732,
        ),
        (
            "./test-data/qumuq/File039.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.37945, 1.45364, "qu")])],
            0.0,
            3.00698,
        ),
        (
            "./test-data/qumuq/File040.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.1963, 1.26353, "qo")])],
            0.0,
            3.00698,
        ),
        (
            "./test-data/qumuq/File041.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.42368, 1.49461, "qo")])],
            0.0,
            3.28562,
        ),
        (
            "./test-data/qumuq/File042.TextGrid",
            ["annotation_0", "annotation_1"],
            [
                ("annotation_0", [(1.21016, 1.27817, "qy")]),
                ("annotation_1", [(1.21016, 1.27817, "qy")]),
            ],
            0.0,
            3.04181,
        ),
        (
            "./test-data/qumuq/File043.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.19227, 1.2347, "qy")])],
            0.0,
            2.75156,
        ),
        (
            "./test-data/qumuq/File044.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.50212, 1.54659, "ge")])],
            0.0,
            3.20435,
        ),
        (
            "./test-data/qumuq/File045.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.16304, 1.25671, "ke")])],
            0.0,
            2.53098,
        ),
        (
            "./test-data/qumuq/File046.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.60763, 1.64487, "kyu")])],
            0.0,
            3.01859,
        ),
        (
            "./test-data/qumuq/File047.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.05913, 1.13002, "kyu")])],
            0.0,
            2.78639,
        ),
        (
            "./test-data/qumuq/File048.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.20758, 1.28556, "kyo")])],
            0.0,
            3.06503,
        ),
        (
            "./test-data/qumuq/File049.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(0.94966, 1.00581, "gyo")])],
            0.0,
            3.16635,
        ),
        (
            "./test-data/qumuq/File050.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.12329, 1.16406, "kyo")])],
            0.0,
            2.93732,
        ),
        (
            "./test-data/qumuq/File051.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.33913, 1.43652, "ki")])],
            0.0,
            3.15791,
        ),
        (
            "./test-data/qumuq/File052.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.32778, 1.4243, "ki")])],
            0.0,
            3.05342,
        ),
        (
            "./test-data/qumuq/File053.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.57661, 1.61533, "gi")])],
            0.0,
            3.58748,
        ),
        (
            "./test-data/qumuq/File054.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.94317, 1.95767, "ge")])],
            0.0,
            3.76163,
        ),
        (
            "./test-data/qumuq/File055.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.13762, 1.17025, "ge")])],
            0.0,
            2.82122,
        ),
        (
            "./test-data/qumuq/File056.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.16062, 1.19915, "gyu")])],
            0.0,
            3.12308,
        ),
        (
            "./test-data/qumuq/File057.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.23125, 1.26045, "gyu")])],
            0.0,
            2.9141,
        ),
        (
            "./test-data/qumuq/File058.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.00529, 1.04492, "gyo")])],
            0.0,
            2.70512,
        ),
        (
            "./test-data/qumuq/File059.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(0.51556, 0.55604, "gi")])],
            0.0,
            2.76317,
        ),
        (
            "./test-data/qumuq/File060.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.49674, 1.53555, "qa")])],
            0.0,
            3.1463,
        ),
        (
            "./test-data/qumuq/File061.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(0.81916, 0.85662, "qa")])],
            0.0,
            3.23918,
        ),
        (
            "./test-data/qumuq/File062.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.29079, 1.31585, "qu")])],
            0.0,
            3.25079,
        ),
        (
            "./test-data/qumuq/File063.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.04925, 1.08233, "qo")])],
            0.0,
            3.06503,
        ),
        (
            "./test-data/qumuq/File064.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.09138, 1.20376, "qo")])],
            0.0,
            3.23918,
        ),
        (
            "./test-data/qumuq/File065.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.92892, 2.0147, "qy")])],
            0.0,
            3.00698,
        ),
        (
            "./test-data/qumuq/File066.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.71294, 1.77112, "kyu")])],
            0.0,
            3.01859,
        ),
        (
            "./test-data/qumuq/File067.TextGrid",
            ["annotation_0"],
            [("annotation_0", [(1.68494, 1.75111, "kyo")])],
            0.0,
            3.06503,
        ),
    ],
)
def test_loading_from_valid_file(
    path: str,
    tier_names: Sequence[str],
    intervals: Sequence[Tuple[str, Sequence[Tuple[float, float, str]]]],
    start_time: float,
    end_time: float,
) -> None:
    loaded_file = TextGridLoader.from_file(path)
    assert isinstance(loaded_file, TextGridLoader)
    assert len(loaded_file.get_tier_names()) == len(tier_names)
    for actual_tier_name, expected_tier_name in zip(
        loaded_file.get_tier_names(), tier_names
    ):
        assert actual_tier_name == expected_tier_name
    assert loaded_file.get_start() == start_time
    assert loaded_file.get_end() == end_time
    offset = 3.1415
    loaded_file.set_offset(offset)
    assert loaded_file.get_start() == start_time + offset
    assert loaded_file.get_end() == end_time + offset
    assert len(loaded_file.get_intervals()) == len(intervals)
    for actual_tier, expected_tier in zip(loaded_file.get_intervals(), intervals):
        actual_tier_name, actual_tier_intervals = actual_tier
        expected_tier_name, expected_tier_intervals = expected_tier
        assert actual_tier_name == expected_tier_name
        assert len(actual_tier_intervals) == len(expected_tier_intervals)
        for actual_interval, expected_interval in zip(
            actual_tier_intervals, expected_tier_intervals
        ):
            expected_start, expected_end, expected_contents = expected_interval
            assert actual_interval.get_start() == expected_start
            assert actual_interval.get_end() == expected_end
            assert actual_interval.get_contents() == expected_contents
